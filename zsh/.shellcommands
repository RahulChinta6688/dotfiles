echo "Load shell commands"

alias subl="/Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl"

newpost() {
  blog_path="$HOME/gitdisk/projects/bitsapien-blog"
  post_file=$(echo "$1" | awk '{print tolower($0)}') # Lowercase
  post_file=${post_file// /-} # Replace spaces with hyphens
  pushd "$blog_path" || return
  hugo new posts/"$post_file.md"
  "$EDITOR" "$blog_path/content/posts/$post_file.md"
}

find_file() {
  find . -name "$1" -type f
}

ckdir() {
  mkdir mkdir "$1" && cd "$1" || exit
}

# refactor
refactor() {
  find "$1" -type f -print0 | xargs -0 -n 1 sed -i -e "s/$2/$3/g"
}
# refactor 2.0
# caution, use this only with git
agr() { ag "$2" -0 -l "$1" | xargs -0 perl -pi -e "s/$2/$3/g"; }

# gets who is using the said port
port_busy() {
  netstat -vanp tcp | grep "$1"
}

de() {
  doom refresh && emacs
}

# Aliases for common websites
al() {
  "$HOME/aliaser" "${1}" "${2}"
}

# offline jwt decode
djwt() {
  jwt `pbpaste` | python -m json.tool | bat -p -ljson
}

djson() {
  pbpaste | python -m json.tool | bat -p -ljson
}

# bash timer
timer() {
  sleep $[${1}*60] && say "${1} minutes are over" && which terminal-notifier && terminal-notifier -message "${1} minutes are over"
}


# make bat usable
alias cat="bat -p"

# Search files using rg
alias rgf='rg --files | rg'

# Add pwd to zsh history
function zshaddhistory() {
  if [[ "${1}" =~ "vi " ]];
  then
    print -sr "${1%%$'\n'} ### ${PWD}"
    fc -p
  fi
}
